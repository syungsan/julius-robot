(self.webpackChunkdask_labextension=self.webpackChunkdask_labextension||[]).push([[319],{319:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>P});var s,a=n(424),i=n(118),r=n(914),o=n(571),l=n(345),d=n(16),c=n(897),u=n(840),h=n(398),m=n(238),p=n(723),g=n(526),v=n(358),C=n(433),b=n(271),k=n(456);class f extends i.MainAreaWidget{constructor(){super({content:new i.IFrame({sandbox:["allow-scripts","allow-same-origin"]})}),this._item=null,this._dashboardUrl="",this._active=!1,this._inactivePanel=s.createInactivePanel(),this.content.node.appendChild(this._inactivePanel),this.update()}get item(){return this._item}set item(e){g.JSONExt.deepEqual(e,this._item)||(this._item=e,this.update())}get dashboardUrl(){return this._dashboardUrl}set dashboardUrl(e){e!==this._dashboardUrl&&(this._dashboardUrl=s.normalizeDashboardUrl(e),this.update())}get active(){return this._active}set active(e){e!==this._active&&(this._active=e,this.update())}onUpdateRequest(){if(!this.item||!this.dashboardUrl||!this.active)return this.content.url="",void(this._inactivePanel.style.display="");this._inactivePanel.style.display="none",this.content.url=h.URLExt.join(this.dashboardUrl,this.item.route)}}class _ extends C.Widget{constructor(e){super();let t=this.layout=new C.PanelLayout;this._dashboard=new C.Widget,this._serverSettings=m.ServerConnection.makeSettings(),this._input=new w(this._serverSettings,e.linkFinder),t.addWidget(this._input),t.addWidget(this._dashboard),this.addClass("dask-DaskDashboardLauncher"),this._items=e.items||[],this._launchItem=e.launchItem,this._input.urlInfoChanged.connect(this._updateLinks,this)}_updateLinks(e,t){if(!t.newValue.isActive)return void this.update();const n=s.getDashboardPlots(t.newValue);this._items=n,this.update()}get items(){return this._items}get input(){return this._input}onUpdateRequest(){this.isVisible&&k.render(b.createElement(y,{launchItem:this._launchItem,isEnabled:this.input.urlInfo.isActive,items:this._items}),this._dashboard.node)}onAfterShow(){this.update()}}class w extends C.Widget{constructor(e,t){super(),this._urlChanged=new u.Signal(this),this._urlInfo={isActive:!1,url:"",plots:{}},this._browserDashboardCheck=!1,this.addClass("dask-URLInput");const n=this.layout=new C.PanelLayout,s=new C.Widget;if(s.addClass("dask-URLInput-wrapper"),this._input=document.createElement("input"),this._input.placeholder="DASK DASHBOARD URL",s.node.appendChild(this._input),n.addWidget(s),this._serverSettings=e,t){const e=new i.ToolbarButton({icon:p.searchIcon,onClick:async()=>{let e=await t();e&&(this.url=e)},tooltip:"Auto-detect dashboard URL"});n.addWidget(e)}this._startUrlCheckTimer()}get input(){return this._input}set url(e){this._input.value=e;const t=this._urlInfo;e!==t.url&&s.testDaskDashboard(e,this._serverSettings,this._browserDashboardCheck).then((n=>{this._urlInfo=n,this._urlChanged.emit({oldValue:t,newValue:n}),this._input.blur(),this.update(),n||console.warn(`${e} does not appear to host a valid Dask dashboard`)}))}get urlInfo(){return this._urlInfo}get urlInfoChanged(){return this._urlChanged}get browserDashboardCheck(){return this._browserDashboardCheck}set browserDashboardCheck(e){this._browserDashboardCheck=e}dispose(){this.isDisposed||(this._poll.dispose(),super.dispose())}handleEvent(e){"keydown"===e.type&&13===e.keyCode&&(e.stopPropagation(),e.preventDefault(),this.url=this._input.value)}onAfterAttach(){this._input.addEventListener("keydown",this,!0)}onBeforeDetach(){this._input.removeEventListener("keydown",this,!0)}_startUrlCheckTimer(){this._poll=new v.Poll({factory:async()=>{const e=this._urlInfo;if(!e.url)return;const t=await s.testDaskDashboard(e.url,this._serverSettings,this._browserDashboardCheck);if(!t.isActive&&e.isActive&&console.warn(`The connection to dask dashboard ${e.url} has been lost`),g.JSONExt.deepEqual(t,e)||(this._urlInfo=t,this._urlChanged.emit({oldValue:e,newValue:t})),!t.isActive)throw Error(`No connection to ${e.url}`)},frequency:{interval:4e3,backoff:!0,max:12e4},standby:"when-hidden"}),this._urlChanged.connect((()=>this._poll.refresh()),this)}}function y(e){if(!e.isEnabled)return b.createElement("div",{className:"dask-DashboardListing-inactive"},b.createElement("span",{className:"dask-DashboardListing-inactive-title"},"Dashboard not connected"),b.createElement("span",{className:"dask-DashboardListing-inactive-detail"},"To connect, paste a dashboard URL in the box above, or create a new Dask cluster with the cluster manager below. If you are still unable to connect, check your network setup."));const t=[...e.items].sort(((e,t)=>e.label<=t.label?-1:1)).map((t=>b.createElement("li",{className:"dask-DashboardListing-item",key:t.route},b.createElement("button",{className:"jp-mod-styled jp-mod-accept",value:t.label,disabled:!e.isEnabled,onClick:()=>e.launchItem(t)},t.label))));return b.createElement("div",null,b.createElement("ul",{className:"dask-DashboardListing-list"},t))}!function(e){function t(e,t=""){if(n(e)){t||(t=h.PageConfig.getBaseUrl());const n=new URL(t);e.startsWith(n.pathname)&&(e=e.slice(n.pathname.length)),e=t+e}return e.endsWith("status")?e=e.slice(0,-"status".length):e.endsWith("status/")&&(e=e.slice(0,-"status/".length)),e}function n(e){const{protocol:t}=h.URLExt.parse(e);return 0!==e.toLowerCase().indexOf(t)&&0!==e.indexOf("//")}e.normalizeDashboardUrl=t,e.getDashboardPlots=function(e){const t=[];for(let n in e.plots){const s=n.replace("Individual ",""),a={route:String(e.plots[n]),label:s,key:s};t.push(a)}return t},e.testDaskDashboard=async function(e,n,s=!1){if(0===(e=t(e,n.baseUrl)).indexOf(n.baseUrl))return m.ServerConnection.makeRequest(h.URLExt.join(e,"individual-plots.json"),{},n).then((async t=>{if(200===t.status){const n=await t.json();return{url:e,isActive:!0,plots:n}}return{url:e,isActive:!1,plots:{}}})).catch((()=>({url:e,isActive:!1,plots:{}})));if(s)return fetch(h.URLExt.join(e,"individual-plots.json")).then((async t=>{if(200===t.status){const n=await t.json();return{url:e,isActive:!0,plots:n}}return{url:e,isActive:!1,plots:{}}})).catch((()=>({url:e,isActive:!1,plots:{}})));const a=await m.ServerConnection.makeRequest(h.URLExt.join(n.baseUrl,"dask","dashboard-check",encodeURIComponent(e)),{},n);return await a.json()},e.createInactivePanel=function(){const e=document.createElement("div");return e.className="dask-DaskDashboard-inactive",e},e.isLocal=n}(s||(s={}));var x,L=n(918),I=n(520),E=n(694);class S extends b.Component{constructor(e){let t;super(e);const n=!!e.initialModel.adapt;t=n?e.initialModel:Object.assign(Object.assign({},e.initialModel),{adapt:{minimum:e.initialModel.workers,maximum:e.initialModel.workers}}),this.state={adaptive:n,model:t}}componentDidUpdate(){let e=Object.assign({},this.state.model);this.state.adaptive||(e.adapt=null),this.props.stateEscapeHatch(e)}onScaleChanged(e){this.setState({model:Object.assign(Object.assign({},this.state.model),{workers:parseInt(e.target.value,10)})})}onScalingChanged(e){const t=e.target.checked;this.setState({model:this.state.model,adaptive:t})}onMinimumChanged(e){const t=parseInt(e.target.value,10),n=Math.max(0,t),s=Math.max(this.state.model.adapt.maximum,n);this.setState({model:Object.assign(Object.assign({},this.state.model),{adapt:{maximum:s,minimum:n}})})}onMaximumChanged(e){const t=parseInt(e.target.value,10),n=Math.max(0,t),s=Math.min(this.state.model.adapt.minimum,n);this.setState({model:Object.assign(Object.assign({},this.state.model),{adapt:{maximum:n,minimum:s}})})}render(){const e=this.state.model,t=e.adapt,n=this.state.adaptive,s="dask-mod-disabled";return b.createElement("div",null,b.createElement("span",{className:"dask-ScalingHeader"},"Manual Scaling"),b.createElement("div",{className:"dask-ScalingSection"},b.createElement("div",{className:"dask-ScalingSection-item"},b.createElement("span",{className:`dask-ScalingSection-label ${n?s:""}`},"Workers"),b.createElement("input",{className:"dask-ScalingInput",disabled:n,value:e.workers,type:"number",step:"1",onChange:e=>{this.onScaleChanged(e)}}))),b.createElement("div",{className:"dask-ScalingHeader"},"Adaptive Scaling",b.createElement("input",{className:"dask-ScalingCheckbox",type:"checkbox",checked:n,onChange:e=>{this.onScalingChanged(e)}})),b.createElement("div",{className:"dask-ScalingSection"},b.createElement("div",{className:"dask-ScalingSection-item"},b.createElement("span",{className:`dask-ScalingSection-label ${n?"":s}`},"Minimum workers"),b.createElement("input",{className:"dask-ScalingInput",disabled:!n,type:"number",value:t.minimum,step:"1",onChange:e=>{this.onMinimumChanged(e)}}))),b.createElement("div",{className:"dask-ScalingSection"},b.createElement("div",{className:"dask-ScalingSection-item"},b.createElement("span",{className:`dask-ScalingSection-label ${n?"":s}`},"Maximum workers"),b.createElement("input",{className:"dask-ScalingInput",disabled:!n,type:"number",value:t.maximum,step:"1",onChange:e=>{this.onMaximumChanged(e)}}))))}}class j extends C.Widget{constructor(e){super(),this._dragData=null,this._clusters=[],this._activeClusterChanged=new u.Signal(this),this._failedServerChecks=0,this._hasServer=!1,this._isReady=!0,this.addClass("dask-DaskClusterManager"),this._serverSettings=m.ServerConnection.makeSettings(),this._injectClientCodeForCluster=e.injectClientCodeForCluster,this._getClientCodeForCluster=e.getClientCodeForCluster,this._registry=e.registry,this._launchClusterId=e.launchClusterId,this._setActiveById=t=>{const n=this._clusters.find((e=>e.id===t));if(!n)return;const s=h.URLExt.join(this._serverSettings.baseUrl,"proxy"),a=new URL(s).pathname;-1!==n.dashboard_link.indexOf(a)?e.setDashboardUrl(n.dashboard_link):e.setDashboardUrl(`dask/dashboard/${n.id}`);const i=this._activeCluster;i&&i.id===n.id||(this._activeCluster=n,this._activeClusterChanged.emit({name:"cluster",oldValue:i,newValue:n}),this.update())};const t=this.layout=new C.PanelLayout;this._clusterListing=new C.Widget,this._clusterListing.addClass("dask-ClusterListing");const n=new i.Toolbar,s=new C.Widget;s.node.textContent="CLUSTERS",s.addClass("dask-DaskClusterManager-label"),n.addItem("label",s),n.addItem("refresh",new i.ToolbarButton({icon:p.refreshIcon,onClick:async()=>this._updateClusterList(),tooltip:"Refresh Cluster List"})),n.addItem(this._launchClusterId,new i.CommandToolbarButton({commands:this._registry,id:this._launchClusterId})),t.addWidget(n),t.addWidget(this._clusterListing),this._updateClusterList(),this._poll=new v.Poll({factory:async()=>{await this._updateClusterList()},frequency:{interval:5e3,backoff:!0,max:6e4},standby:"when-hidden"})}get activeCluster(){return this._activeCluster}setActiveCluster(e){this._setActiveById(e)}get activeClusterChanged(){return this._activeClusterChanged}get isReady(){return this._isReady}get clusters(){return this._clusters}async refresh(){await this._updateClusterList()}async start(){return await this._launchCluster()}async stop(e){if(!this._clusters.find((t=>t.id===e)))throw Error(`Cannot find cluster ${e}`);await this._stopById(e)}async scale(e){if(!this._clusters.find((t=>t.id===e)))throw Error(`Cannot find cluster ${e}`);return await this._scaleById(e)}dispose(){this.isDisposed||(this._poll.dispose(),super.dispose())}onUpdateRequest(e){this.isVisible&&k.render(b.createElement(D,{clusters:this._clusters,activeClusterId:this._activeCluster&&this._activeCluster.id||"",scaleById:e=>this._scaleById(e),stopById:e=>this._stopById(e),setActiveById:this._setActiveById,injectClientCodeForCluster:this._injectClientCodeForCluster}),this._clusterListing.node)}onAfterShow(e){this.update()}onAfterAttach(e){super.onAfterAttach(e);let t=this._clusterListing.node;t.addEventListener("p-dragenter",this),t.addEventListener("p-dragleave",this),t.addEventListener("p-dragover",this),t.addEventListener("mousedown",this)}onBeforeDetach(e){let t=this._clusterListing.node;t.removeEventListener("p-dragenter",this),t.removeEventListener("p-dragleave",this),t.removeEventListener("p-dragover",this),t.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this,!0),document.removeEventListener("mousemove",this,!0)}handleEvent(e){switch(e.type){case"mousedown":this._evtMouseDown(e);break;case"mouseup":this._evtMouseUp(e);break;case"mousemove":this._evtMouseMove(e)}}_evtMouseDown(e){const{button:t,shiftKey:n}=e;if(0!==t&&2!==t)return;if(n&&2===t)return;const s=this._findCluster(e);-1!==s&&(this._dragData={pressX:e.clientX,pressY:e.clientY,index:s},document.addEventListener("mouseup",this,!0),document.addEventListener("mousemove",this,!0),e.preventDefault())}_evtMouseUp(e){0===e.button&&this._drag||(document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!0)),e.preventDefault(),e.stopPropagation()}_evtMouseMove(e){let t=this._dragData;if(!t)return;let n=Math.abs(e.clientX-t.pressX),s=Math.abs(e.clientY-t.pressY);(n>=5||s>=5)&&(e.preventDefault(),e.stopPropagation(),this._startDrag(t.index,e.clientX,e.clientY))}async _startDrag(e,t,n){const s=this._clusters[e],a=this._clusterListing.node.querySelector(`li.dask-ClusterListingItem[data-cluster-id="${s.id}"]`),i=x.createDragImage(a);this._drag=new E.Drag({mimeData:new g.MimeData,dragImage:i,supportedActions:"copy",proposedAction:"copy",source:this});const r=this._getClientCodeForCluster(s);this._drag.mimeData.setData("text/plain",r);const o=[{cell_type:"code",source:r,outputs:[],execution_count:null,metadata:{}}];return this._drag.mimeData.setData("application/vnd.jupyter.cells",o),document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!0),this._drag.start(t,n).then((e=>{this.isDisposed||(this._drag=null,this._dragData=null)}))}async _launchCluster(){this._isReady=!1,this._registry.notifyCommandChanged(this._launchClusterId);const e=await m.ServerConnection.makeRequest(`${this._serverSettings.baseUrl}dask/clusters`,{method:"PUT"},this._serverSettings);if(200!==e.status){const t=await e.json();throw(0,i.showErrorMessage)("Cluster Start Error",t),this._isReady=!0,this._registry.notifyCommandChanged(this._launchClusterId),t}const t=await e.json();return await this._updateClusterList(),this._isReady=!0,this._registry.notifyCommandChanged(this._launchClusterId),t}async _updateClusterList(){const e=await m.ServerConnection.makeRequest(`${this._serverSettings.baseUrl}dask/clusters`,{},this._serverSettings);if(200!==e.status){this._failedServerChecks++;const e=new Error("Failed to list Dask clusters: might the server extension not be installed/enabled?");throw this._hasServer||5!=this._failedServerChecks||(0,i.showErrorMessage)("Dask Server Error",e),e}this._hasServer=!0;const t=await e.json();if(this._clusters=t,!this._clusters.find((e=>e.id===(this._activeCluster&&this._activeCluster.id)))){const e=this._clusters[0]&&this._clusters[0].id||"";this._setActiveById(e)}this.update()}async _stopById(e){const t=await m.ServerConnection.makeRequest(`${this._serverSettings.baseUrl}dask/clusters/${e}`,{method:"DELETE"},this._serverSettings);if(204!==t.status){const e=await t.json();throw(0,i.showErrorMessage)("Failed to close cluster",e),e}await this._updateClusterList()}async _scaleById(e){const t=this._clusters.find((t=>t.id===e));if(!t)throw Error(`Failed to find cluster ${e} to scale`);const n=await function(e){let t=Object.assign({},e);return(0,i.showDialog)({title:`Scale ${e.name}`,body:b.createElement(S,{initialModel:e,stateEscapeHatch:e=>{t=e}}),buttons:[i.Dialog.cancelButton(),i.Dialog.okButton({label:"SCALE"})]}).then((n=>n.button.accept?t:e))}(t);if(g.JSONExt.deepEqual(n,t))return Promise.resolve(t);const s=await m.ServerConnection.makeRequest(`${this._serverSettings.baseUrl}dask/clusters/${e}`,{method:"PATCH",body:JSON.stringify(n)},this._serverSettings);if(200!==s.status){const e=await s.json();throw(0,i.showErrorMessage)("Failed to scale cluster",e),e}const a=await s.json();return await this._updateClusterList(),a}_findCluster(e){const t=Array.from(this.node.querySelectorAll("li.dask-ClusterListingItem"));return L.ArrayExt.findFirstIndex(t,(t=>I.ElementExt.hitTest(t,e.clientX,e.clientY)))}}function D(e){let t=e.clusters.map((t=>b.createElement(M,{isActive:t.id===e.activeClusterId,key:t.id,cluster:t,scale:()=>e.scaleById(t.id),stop:()=>e.stopById(t.id),setActive:()=>e.setActiveById(t.id),injectClientCode:()=>e.injectClientCodeForCluster(t)})));return b.createElement("div",null,b.createElement("ul",{className:"dask-ClusterListing-list"},t))}function M(e){const{cluster:t,isActive:n,setActive:s,scale:a,stop:i,injectClientCode:r}=e;let o="dask-ClusterListingItem";o=n?`${o} jp-mod-active`:o;let l=null,d=null;return t.adapt&&(l=b.createElement("div",{className:"dask-ClusterListingItem-stats"},"Minimum Workers: ",t.adapt.minimum),d=b.createElement("div",{className:"dask-ClusterListingItem-stats"},"Maximum Workers: ",t.adapt.maximum)),b.createElement("li",{className:o,"data-cluster-id":t.id,onClick:e=>{s(),e.stopPropagation()}},b.createElement("div",{className:"dask-ClusterListingItem-title"},t.name),b.createElement("div",{className:"dask-ClusterListingItem-link",title:t.scheduler_address},"Scheduler Address: ",t.scheduler_address),b.createElement("div",{className:"dask-ClusterListingItem-link"},"Dashboard URL:"," ",b.createElement("a",{target:"_blank",rel:"noreferrer",href:t.dashboard_link,title:t.dashboard_link},t.dashboard_link)),b.createElement("div",{className:"dask-ClusterListingItem-stats"},"Number of Cores: ",t.cores),b.createElement("div",{className:"dask-ClusterListingItem-stats"},"Memory: ",t.memory),b.createElement("div",{className:"dask-ClusterListingItem-stats"},"Number of Workers: ",t.workers),l,d,b.createElement("div",{className:"dask-ClusterListingItem-button-panel"},b.createElement("button",{className:"dask-ClusterListingItem-button dask-ClusterListingItem-code dask-CodeIcon jp-mod-styled",onClick:e=>{r(),e.stopPropagation()},title:`Inject client code for ${t.name}`}),b.createElement("button",{className:"dask-ClusterListingItem-button dask-ClusterListingItem-scale jp-mod-styled",onClick:async e=>(e.stopPropagation(),a()),title:`Rescale ${t.name}`},"SCALE"),b.createElement("button",{className:"dask-ClusterListingItem-button dask-ClusterListingItem-stop jp-mod-styled",onClick:async e=>(e.stopPropagation(),i()),title:`Shutdown ${t.name}`},"SHUTDOWN")))}!function(e){e.createDragImage=function(e){const t=e.cloneNode(!0);return t.classList.add("dask-ClusterListingItem-drag"),t}}(x||(x={}));class U extends C.Widget{constructor(e){super(),this.addClass("dask-DaskSidebar");let t=this.layout=new C.PanelLayout;this._dashboard=new _({launchItem:e.launchDashboardItem,linkFinder:e.linkFinder});const n=e.clientCodeInjector,s=e.clientCodeGetter;this._clusters=new j({registry:e.registry,launchClusterId:e.launchClusterId,setDashboardUrl:e=>{this._dashboard.input.url=e},injectClientCodeForCluster:n,getClientCodeForCluster:s}),t.addWidget(this._dashboard),t.addWidget(this._clusters)}get dashboardLauncher(){return this._dashboard}get clusterManager(){return this._clusters}}var A,N=n(379),R=n.n(N),B=n(760);R()(B.Z,{insert:"head",singleton:!1}),B.Z.locals,function(e){e.launchPanel="dask:launch-dashboard",e.injectClientCode="dask:inject-client-code",e.launchCluster="dask:launch-cluster",e.stopCluster="dask:stop-cluster",e.scaleCluster="dask:scale-cluster",e.toggleAutoStartClient="dask:toggle-auto-start-client"}(A||(A={}));const F="dask-labextension:plugin",P={activate:async function(e,t,n,s,a,r,o,l,d){const c="dask-dashboard-launcher",h=t=>{const s=W.getCurrentEditor(e,o,n);s&&W.injectClientCode(t,s)},m=new U({launchDashboardItem:t=>{e.commands.execute(A.launchPanel,t)},linkFinder:async()=>{const e=W.getCurrentKernel(s,o,n);return await W.shouldUseKernel(e)?await W.checkKernel(e):""},clientCodeInjector:h,clientCodeGetter:W.getClientCode,registry:e.commands,launchClusterId:A.launchCluster});m.id=c,m.title.iconClass="dask-DaskLogo jp-SideBar-tabIcon",m.title.caption="Dask";const p=new i.WidgetTracker({namespace:"dask-dashboard-launcher"});a.add(m,c),a.restore(p,{command:A.launchPanel,args:e=>e.item||{},name:e=>e.item&&e.item.route||""}),s.add(m,"left",{rank:200});const g=()=>{const e=m.dashboardLauncher.input,t=m.dashboardLauncher.items;p.forEach((n=>{const s=t.find((e=>{var t;return(null===(t=n.item)||void 0===t?void 0:t.route)===e.route}));if(!s||!e.urlInfo.isActive)return n.active=!1,void(n.dashboardUrl="");`${s.label}`!==n.title.label&&(n.title.label=`${s.label}`),n.dashboardUrl=e.urlInfo.effectiveUrl||e.urlInfo.url,n.active=!0}))};m.dashboardLauncher.input.urlInfoChanged.connect((async(e,t)=>{g();const n=m.clusterManager.activeCluster;return d.save(c,{url:t.newValue.url,cluster:n?n.id:""})})),m.clusterManager.activeClusterChanged.connect((async()=>{const e=m.clusterManager.activeCluster;return d.save(c,{url:m.dashboardLauncher.input.urlInfo.url,cluster:e?e.id:""})})),g();const v=async e=>{if(!e)return;const t=m.clusterManager.activeCluster;return t&&await W.shouldUseKernel(e.kernel)?W.createClientForKernel(t,e.kernel):void 0},C=[o,n],b=async e=>{if(e.session&&e.session.kernel&&"restarting"===e.session.kernel.status)return v(e.session)},k=(e,t)=>{t.sessionContext.statusChanged.connect(b)},_=()=>{C.forEach((e=>{e.forEach((async e=>{const t=e.sessionContext.session;if(t&&await W.shouldUseKernel(t.kernel))return v(t)}))}))};let w=!1,y=!1,x=!1;Promise.all([l.load(F),d.fetch(c)]).then((async e=>{const t=e[0];if(!t)return void console.warn("Unable to retrieve dask-labextension settings");const n=e[1],s=n?n.url:"",a=n?n.cluster:"",i=m.dashboardLauncher.input.urlInfo.effectiveUrl||m.dashboardLauncher.input.urlInfo.url;m.dashboardLauncher.input.url=s&&!i?s:t.get("defaultURL").composite;const r=()=>{w=t.get("autoStartClient").composite,u.Signal.clearData(k),u.Signal.clearData(b),u.Signal.clearData(_),w&&(C.forEach((e=>{e.widgetAdded.connect(k)})),C.forEach((e=>{e.forEach((async e=>{await v(e.sessionContext.session),e.sessionContext.statusChanged.connect(b)}))})),m.clusterManager.activeClusterChanged.connect(_)),x=t.get("browserDashboardCheck").composite,m.dashboardLauncher.input.browserDashboardCheck=x,y=t.get("hideClusterManager").composite,m.clusterManager.setHidden(y)};r(),t.changed.connect(r),a&&(await m.clusterManager.refresh(),m.clusterManager.setActiveCluster(a))})),e.commands.addCommand(A.launchPanel,{label:e=>`Launch Dask ${e.label||""} Dashboard`,caption:"Launch a Dask dashboard",execute:e=>{const t=m.dashboardLauncher.input.urlInfo,n=t.effectiveUrl||t.url,a=t.isActive,i=e,r=p.find((e=>!(!e||!e.item||e.item.route!==i.route)));if(r)return r.isAttached||s.add(r,"main"),void s.activateById(r.id);const o=new f;return o.dashboardUrl=n,o.item=i,o.active=a,o.id="dask-dashboard-"+W.id++,o.title.label=`${i.label}`,o.title.icon="dask-DaskLogo",s.add(o,"main"),p.add(o),o}}),e.commands.addCommand(A.injectClientCode,{label:"Inject Dask Client Connection Code",execute:()=>{const t=W.clusterFromClick(e,m.clusterManager);t&&h(t)}}),e.commands.addCommand(A.launchCluster,{label:e=>e.isPalette?"Launch New Cluster":"NEW",execute:()=>m.clusterManager.start(),iconClass:e=>e.isPalette?"":"jp-AddIcon jp-Icon jp-Icon-16",isEnabled:()=>m.clusterManager.isReady,caption:()=>m.clusterManager.isReady?"Start New Dask Cluster":"Cluster starting..."}),e.commands.addCommand(A.stopCluster,{label:"Shutdown Cluster",execute:()=>{const t=W.clusterFromClick(e,m.clusterManager);if(t)return m.clusterManager.stop(t.id)}}),e.commands.addCommand(A.scaleCluster,{label:"Scale Clusterâ€¦",execute:()=>{const t=W.clusterFromClick(e,m.clusterManager);if(t)return m.clusterManager.scale(t.id)}}),e.commands.addCommand(A.toggleAutoStartClient,{label:"Auto-Start Dask",isToggled:()=>w,execute:async()=>{const e=!w,t="autoStartClient";return l.set(F,t,e).catch((e=>{console.error(`Failed to set ${F}:${t} - ${e.message}`)}))}}),r.settingsMenu.addGroup([{command:A.toggleAutoStartClient}]),[A.launchCluster,A.toggleAutoStartClient].forEach((e=>{t.addItem({category:"Dask",command:e,args:{isPalette:!0}})})),e.contextMenu.addItem({command:A.injectClientCode,selector:".dask-ClusterListingItem",rank:10}),e.contextMenu.addItem({command:A.stopCluster,selector:".dask-ClusterListingItem",rank:3}),e.contextMenu.addItem({command:A.scaleCluster,selector:".dask-ClusterListingItem",rank:2}),e.contextMenu.addItem({command:A.launchCluster,selector:".dask-ClusterListing-list",rank:1})},id:F,requires:[i.ICommandPalette,r.IConsoleTracker,a.ILabShell,a.ILayoutRestorer,o.IMainMenu,c.INotebookTracker,l.ISettingRegistry,d.IStateDB],autoStart:!0};var W;!function(e){function t(e){return`from dask.distributed import Client\n\nclient = Client("${e.scheduler_address}")\nclient`}e.id=0,e.shouldUseKernel=async function(e){if(!e)return!1;const t=await e.spec;return!!t&&-1!==t.language.toLowerCase().indexOf("python")},e.checkKernel=function(e){const t={store_history:!1,code:"try:\n  from dask.distributed import default_client as _internal_jlab_default_client\n  display(_internal_jlab_default_client().dashboard_link)\nexcept:\n  pass"};return new Promise(((n,s)=>{e.requestExecute(t).onIOPub=e=>{if("display_data"!==e.header.msg_type)return;const t=e.content.data["text/plain"]||"";console.log(`Found dashboard link at ${t}`),n(t.replace(/'/g,"").split("status")[0])}}))},e.createClientForKernel=async function(e,t){const n={store_history:!1,code:`import dask; from dask.distributed import Client\ndask.config.set({'scheduler-address': '${e.scheduler_address}'})\nclient = Client()`};return new Promise(((e,s)=>{t.requestExecute(n).onIOPub=t=>{"display_data"===t.header.msg_type&&e(void 0)}}))},e.injectClientCode=function(e,n){const s=n.getCursorPosition(),a=n.getOffsetAt(s),i=t(e);n.model.value.insert(a,i)},e.getClientCode=t,e.getCurrentKernel=function(e,t,n){var s,a,i,r;let o,l=e.currentWidget;return l&&t.has(l)?o=null===(s=l.sessionContext.session)||void 0===s?void 0:s.kernel:l&&n.has(l)?o=null===(a=l.sessionContext.session)||void 0===a?void 0:a.kernel:t.currentWidget?o=null===(i=t.currentWidget.sessionContext.session)||void 0===i?void 0:i.kernel:n.currentWidget&&(o=null===(r=n.currentWidget.sessionContext.session)||void 0===r?void 0:r.kernel),o},e.getCurrentEditor=function(e,t,n){let s,a=e.shell.currentWidget;if(a&&t.has(a)){c.NotebookActions.insertAbove(a.content);const e=a.content.activeCell;s=e&&e.editor}else if(a&&n.has(a)){const e=a.console.promptCell;s=e&&e.editor}else if(t.currentWidget){const e=t.currentWidget;c.NotebookActions.insertAbove(e.content);const n=e.content.activeCell;s=n&&n.editor}else if(n.currentWidget){const e=n.currentWidget.console.promptCell;s=e&&e.editor}return s},e.clusterFromClick=function(e,t){const n=e.contextMenuHitTest((e=>!!e.dataset.clusterId));if(!n)return;const s=n.dataset.clusterId;return t.clusters.find((e=>e.id===s))}}(W||(W={}))},760:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var s=n(645),a=n.n(s),i=n(667),r=n.n(i),o=n(637),l=n.n(o),d=n(490),c=n.n(d),u=n(935),h=n.n(u),m=a()((function(e){return e[1]})),p=r()(l()),g=r()(c()),v=r()(h());m.push([e.id,":root {\n  --dask-launch-button-height: 24px;\n}\n\n/**\n * Rules related to the overall sidebar panel.\n */\n\n.dask-DaskSidebar {\n  background: var(--jp-layout-color1);\n  color: var(--jp-ui-font-color1);\n  font-size: var(--jp-ui-font-size1);\n  overflow: auto;\n}\n\n/**\n * Rules related to the dashboard launcher.\n */\n\n.dask-DashboardListing-inactive {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  height: 600px;\n  color: var(--jp-ui-font-color3);\n}\n\n.dask-DashboardListing-inactive-title {\n  font-size: var(--jp-ui-font-size3);\n  padding: 24px;\n  text-align: center;\n}\n\n.dask-DashboardListing-inactive-detail {\n  font-size: var(--jp-ui-font-size4);\n  padding: 24px;\n}\n\n.dask-DashboardListing-inactive:before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 80%;\n  height: 80%;\n  background-image: url("+p+");\n  background-repeat: no-repeat;\n  background-position: center;\n  opacity: 0.1;\n}\n\n.dask-DashboardListing-list {\n  margin: 8px;\n  padding: 0;\n  list-style-type: none;\n}\n\n.dask-DashboardListing-item {\n  margin-top: 4px;\n  margin-bottom: 4px;\n  margin-left: 12px;\n  margin-right: 12px;\n  white-space: nowrap;\n}\n\n.dask-DashboardListing-item button {\n  font-size: var(--jp-ui-font-size0);\n  border-radius: 2px;\n  line-height: 1em;\n  padding: 0px 8px;\n  width: 100%;\n}\n\n.dask-DashboardListing-item button.jp-mod-styled.jp-mod-accept {\n  height: var(--dask-launch-button-height);\n  color: #262326;\n  background-color: #ffc11e;\n  border: 1px solid #ffc11e;\n  text-transform: uppercase;\n}\n\n.dask-URLInput {\n  padding: 8px;\n  display: flex;\n  align-items: center;\n  background-color: var(--jp-layout-color1);\n  border-bottom: 1px solid var(--jp-border-color2);\n  box-shadow: var(--jp-toolbar-box-shadow);\n  z-index: 2;\n}\n\n.dask-URLInput-wrapper {\n  background-color: var(--jp-input-active-background);\n  border: var(--jp-border-width) solid var(--jp-border-color2);\n  flex: 1 1 auto;\n  height: 30px;\n  padding: 0px 12px;\n  margin: 0 4px 0 0;\n}\n\n.dask-URLInput-wrapper:focus-within {\n  border: var(--jp-border-width) solid var(--md-blue-500);\n  box-shadow: inset 0 0 4px var(--md-blue-300);\n}\n\n.dask-URLInput-wrapper input {\n  background: transparent;\n  float: left;\n  border: none;\n  outline: none;\n  font-size: var(--jp-ui-font-size1);\n  color: var(--jp-ui-font-color0);\n  width: calc(100% - 18px);\n  line-height: 28px;\n}\n\n.dask-URLInput-wrapper::placeholder {\n  color: var(--jp-ui-font-color3);\n  font-size: var(--jp-ui-font-size1);\n}\n\n.dask-UrlInput .jp-ToolbarButton {\n  flex: 0 0 auto;\n  margin: 0 0 0 4px;\n  background-color: var(--jp-layout-color2);\n  min-width: 16px;\n}\n\n/**\n * Rules for the dashboard panels.\n */\n.dask-DaskDashboard-inactive {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: var(--jp-ui-font-color3);\n  font-size: var(--jp-ui-font-size3);\n  background-color: var(--jp-layout-color0);\n  z-index: 10;\n}\n\n.dask-DaskDashboard-inactive:before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-image: url("+p+");\n  background-repeat: no-repeat;\n  background-position: center;\n  opacity: 0.1;\n}\n\n/**\n * Rules related to the cluster manager.\n */\n\n.dask-DaskClusterManager {\n  border-top: 6px solid var(--jp-toolbar-border-color);\n}\n\n.dask-DaskClusterManager .jp-Toolbar {\n  align-items: center;\n}\n\n.dask-DaskClusterManager .jp-Toolbar .dask-DaskClusterManager-label {\n  flex: 0 0 auto;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n  font-size: var(--jp-ui-font-size0);\n  padding: 8px 8px 8px 12px;\n  margin: 0px;\n}\n\n.dask-DaskClusterManager button.jp-Button > span {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.dask-ClusterListing ul.dask-ClusterListing-list {\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n}\n\n.dask-ClusterListingItem {\n  display: inline-block;\n  list-style-type: none;\n  padding: 8px;\n  width: 100%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  cursor: grab;\n}\n\n.dask-ClusterListingItem-drag {\n  opacity: 0.7;\n  color: var(--jp-ui-font-color1);\n  cursor: grabbing;\n  max-width: 260px;\n  transform: translateX(-50%) translateY(-50%);\n}\n\n.dask-ClusterListingItem-title {\n  margin: 0px;\n  font-size: var(--jp-ui-font-size2);\n}\n\n.dask-ClusterListingItem-link a {\n  text-decoration: none;\n  color: var(--jp-content-link-color);\n}\n\n.dask-ClusterListingItem-link a:hover {\n  text-decoration: underline;\n}\n\n.dask-ClusterListingItem-link a:visited {\n  color: var(--jp-content-link-color);\n}\n\n.dask-ClusterListingItem:hover {\n  background: var(--jp-layout-color2);\n}\n\n.dask-ClusterListingItem.jp-mod-active {\n  color: white;\n  background: var(--jp-brand-color0);\n}\n\n.dask-ClusterListingItem.jp-mod-active a,\n.dask-ClusterListingItem.jp-mod-active a:visited {\n  color: white;\n}\n\n.dask-ClusterListingItem button.jp-mod-styled {\n  background-color: transparent;\n}\n\n.dask-ClusterListingItem button.jp-mod-styled:hover {\n  background-color: var(--jp-layout-color3);\n}\n\n.dask-ClusterListingItem.jp-mod-active button.jp-mod-styled:hover {\n  background-color: var(--jp-brand-color1);\n}\n\n.dask-ClusterListingItem-button-panel {\n  display: flex;\n  align-content: center;\n}\n\nbutton.dask-ClusterListingItem-stop {\n  color: var(--jp-warn-color1);\n  font-weight: 600;\n}\n\nbutton.dask-ClusterListingItem-scale {\n  color: var(--jp-accent-color1);\n  font-weight: 600;\n}\n\n.dask-ClusterListingItem button.dask-ClusterListingItem-code.jp-mod-styled {\n  margin: 0 4px 0 4px;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n\n/**\n * Rules for the scaling dialog.\n */\n\n.dask-ScalingHeader {\n  font-size: var(--jp-ui-font-size2);\n}\n\n.dask-ScalingSection {\n  margin-left: 24px;\n}\n\n.dask-ScalingSection-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  margin: 12px 0 12px 0;\n}\n\n.dask-ScalingHeader input[type='checkbox'] {\n  position: relative;\n  top: 4px;\n  left: 4px;\n  margin: 0 0 0 8px;\n}\n\n.dask-ScalingSection input[type='number'] {\n  width: 72px;\n}\n\n.dask-ScalingSection-label.dask-mod-disabled {\n  color: var(--jp-ui-font-color3);\n}\n\n.dask-ScalingSection input[type='number']:disabled {\n  color: var(--jp-ui-font-color3);\n}\n\n/**\n * Rules for the logos.\n */\n\n.dask-SearchIcon {\n  background-image: var(--jp-icon-search);\n}\n\n[data-jp-theme-light='true'] .dask-CodeIcon {\n  background-image: url("+g+");\n}\n\n[data-jp-theme-light='false'] .dask-CodeIcon {\n  background-image: url("+v+");\n}\n\n.dask-ClusterListingItem.jp-mod-active .dask-CodeIcon {\n  background-image: url("+v+");\n}\n\n.dask-DaskLogo {\n  background-image: url("+p+");\n}\n\n#setting-editor .dask-DaskLogo {\n  background-repeat: no-repeat;\n  background-size: 85%;\n  background-position: center;\n}\n",""]);const C=m},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,s){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(s)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(a[r]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);s&&a[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},667:e=>{"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},379:(e,t,n)=>{"use strict";var s,a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function r(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function o(e,t){for(var n={},s=[],a=0;a<e.length;a++){var o=e[a],l=t.base?o[0]+t.base:o[0],d=n[l]||0,c="".concat(l," ").concat(d);n[l]=d+1;var u=r(c),h={css:o[1],media:o[2],sourceMap:o[3]};-1!==u?(i[u].references++,i[u].updater(h)):i.push({identifier:c,updater:g(h,t),references:1}),s.push(c)}return s}function l(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var i=n.nc;i&&(s.nonce=i)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var r=a(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var d,c=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function u(e,t,n,s){var a=n?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=c(t,a);else{var i=document.createTextNode(a),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}function h(e,t,n){var s=n.css,a=n.media,i=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var m=null,p=0;function g(e,t){var n,s,a;if(t.singleton){var i=p++;n=m||(m=l(t)),s=u.bind(null,n,i,!1),a=u.bind(null,n,i,!0)}else n=l(t),s=h.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var n=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<n.length;s++){var a=r(n[s]);i[a].references--}for(var l=o(e,t),d=0;d<n.length;d++){var c=r(n[d]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}n=l}}}},935:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23E0E0E0' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z'/%3E%3C/svg%3E"},490:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23616161' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z'/%3E%3C/svg%3E"},637:e=>{e.exports="data:image/svg+xml,%3C!-- Generator: Adobe Illustrator 26.0.3, SVG Export Plug-In . SVG Version: 6.00 Build 0) --%3E %3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'%3E %3Cstyle type='text/css'%3E .st0%7Bfill:%23FFC11E;%7D .st1%7Bfill:%2304255C;%7D .st2%7Bfill:%23FC6E6B;%7D .st3%7Bfill:%23FFFFFF;%7D .st4%7Bfill:%23EF1161;%7D %3C/style%3E %3Cg%3E %3Cpath class='st0' d='M143.71,157.61l126.5-72.99c1.25-0.72,2.02-2.05,2.02-3.5l0.01-43.77c0-6.48-2.66-12.9-7.83-16.81 c-6.69-5.06-15.28-5.56-22.33-1.48L65.13,121.17c-6.22,3.59-10.06,10.23-10.06,17.41L55,369.18c0,6.47,2.65,12.89,7.81,16.81 c6.68,5.07,15.29,5.57,22.35,1.49l37.48-21.62c1.25-0.72,2.02-2.05,2.02-3.5l0.05-171.85C124.71,176.93,131.95,164.4,143.71,157.61 z'/%3E %3Cpath class='st4' d='M446.95,124.53c-3.15-1.82-6.61-2.73-10.06-2.73c-3.45,0-6.9,0.91-10.05,2.73l-176.96,102.1 c-6.2,3.58-10.06,10.25-10.06,17.41l-0.07,231.47c0,7.27,3.76,13.78,10.05,17.42c6.3,3.64,13.81,3.64,20.11,0l176.95-102.11 c6.2-3.58,10.06-10.25,10.06-17.41L457,141.95C457,134.68,453.24,128.16,446.95,124.53z'/%3E %3Cpath class='st2' d='M240.95,211.14l116.78-67.38c1.25-0.72,2.02-2.05,2.02-3.5l0.02-50.98c0-6.48-2.66-12.9-7.83-16.81 c-6.69-5.06-15.27-5.55-22.33-1.48l-48.43,27.95L152.64,173.1c-6.22,3.59-10.06,10.23-10.06,17.41l-0.05,174.18l-0.02,56.41 c0,6.48,2.65,12.89,7.81,16.81c6.69,5.07,15.29,5.57,22.35,1.49l47.2-27.24c1.25-0.72,2.02-2.05,2.02-3.5l0.05-164.64 C221.95,230.46,229.19,217.92,240.95,211.14z'/%3E %3C/g%3E %3C/svg%3E"}}]);